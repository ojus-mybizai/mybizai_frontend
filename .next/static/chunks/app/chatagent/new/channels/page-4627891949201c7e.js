(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[424],{6539:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]])},2176:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]])},6020:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},8487:function(e,t,a){Promise.resolve().then(a.bind(a,7900))},7900:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var s=a(7437),n=a(2265),c=a(4033),i=a(2247),r=a(6959),o=a(2882),l=a(6539),d=a(2176),g=a(6020),h=a(1720);let u=[{id:"whatsapp",name:"WhatsApp Business",icon:(0,s.jsx)(o.Z,{className:"w-5 h-5"}),description:"Connect your WhatsApp Business account",status:"available"},{id:"instagram",name:"Instagram Direct",icon:(0,s.jsx)(l.Z,{className:"w-5 h-5"}),description:"Connect your Instagram Business account",status:"available"},{id:"messenger",name:"Facebook Messenger",icon:(0,s.jsx)(d.Z,{className:"w-5 h-5"}),description:"Connect your Facebook Page",status:"available"},{id:"telegram",name:"Telegram Bot",icon:(0,s.jsx)(g.Z,{className:"w-5 h-5"}),description:"Connect your Telegram bot",status:"coming_soon"}];function m(e){let{channelsEnabled:t={},onChange:a}=e;return(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Channel Integration"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Connect your chat agent to messaging platforms"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Available Channels"}),(0,s.jsx)("div",{className:"space-y-3",children:u.map(e=>{let a=t[e.id]||!1;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg transition-all ".concat("coming_soon"===e.status?"opacity-60 bg-gray-50 dark:bg-gray-800/50":""),children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg ".concat("available"===e.status?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-400"),children:e.icon}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),"coming_soon"===e.status&&(0,s.jsx)("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full",children:"Coming Soon"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.description}),"available"===e.status&&(0,s.jsx)("div",{className:"flex items-center mt-2",children:(0,s.jsx)("span",{className:"text-xs ".concat(a?"text-green-600 dark:text-green-400":"text-gray-500"),children:a?"● Active":"○ Inactive"})})]})]}),"available"===e.status&&(0,s.jsx)("div",{className:"flex items-center space-x-3",children:"whatsapp"===e.id||"instagram"===e.id||"messenger"===e.id?(0,s.jsx)(h.Z,{channel:e.id}):(0,s.jsx)(i.z,{size:"sm",disabled:!0,children:"Coming Soon"})})]},e.id)})})]})]})}var x=a(3062),p=a(7071);function f(){let e=(0,c.useRouter)(),t=(0,c.useSearchParams)(),{accessToken:a}=(0,x.tN)(),[o,l]=(0,n.useState)({}),[d,g]=(0,n.useState)(null),[h,u]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=t.get("agentId");e&&g(parseInt(e))},[t]);let f=async()=>{if(!d||!a){alert("Agent ID is missing. Please go back to the profile step.");return}try{u(!0),await p.TJ.updateChatAgent(d,{channels_enabled:o},a),e.push("/chatagent/new/tools?agentId=".concat(d))}catch(e){console.error("Failed to update agent channels:",e),alert("Failed to save channel configuration. Please try again.")}finally{u(!1)}};return d?(0,s.jsx)(r.Z,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Channel Integration"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Connect your chat agent to messaging platforms where customers can reach you"})]}),(0,s.jsx)(m,{channelsEnabled:o,onChange:l}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)(i.z,{variant:"outline",onClick:()=>{if(!d){alert("Agent ID is missing. Please go back to the profile step.");return}e.push("/chatagent/new/tools?agentId=".concat(d))},disabled:h,children:"Skip for now"}),(0,s.jsx)(i.z,{onClick:f,disabled:h,isLoading:h,children:h?"Saving...":"Continue to Tools"})]})]})}):(0,s.jsx)(r.Z,{children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Agent not found"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Please go back to the profile step to create an agent first."}),(0,s.jsx)(i.z,{onClick:()=>e.push("/chatagent/new/profile"),children:"Back to Profile"})]})})}},1720:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var s=a(7437),n=a(2265),c=a(3062);function i(e){let{channel:t}=e,[a,i]=(0,n.useState)(!1),{accessToken:r}=(0,c.tN)(),o=()=>{switch(t){case"instagram":return"pages_show_list,pages_manage_metadata,instagram_basic,instagram_manage_messages,pages_messaging";case"messenger":return"pages_show_list,pages_manage_metadata,pages_messaging";default:return"whatsapp_business_management,whatsapp_business_messaging,business_management"}},l=()=>"http://localhost:8000/api/v1/auth/facebook/exchange?channel=".concat(t);return(0,s.jsx)("button",{onClick:()=>{if(!window.FB){alert("Facebook SDK not loaded yet!");return}i(!0),window.FB.login(function(e){e.authResponse?(console.log("FB login success for ".concat(t,":"),e.authResponse),fetch(l(),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify({accessToken:e.authResponse.accessToken,state:{channel:t}})}).then(e=>e.json()).then(e=>{console.log("Backend exchange result:",e),alert("".concat(t.charAt(0).toUpperCase()+t.slice(1)," connected successfully!"))}).catch(e=>{console.error("Error connecting ".concat(t,":"),e),alert("Something went wrong while connecting ".concat(t,"."))}).finally(()=>i(!1))):(alert("Login failed or cancelled"),i(!1))},{scope:o()})},disabled:a,className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:a?"Connecting ".concat(t,"..."):"Connect ".concat(t.charAt(0).toUpperCase()+t.slice(1))})}}},function(e){e.O(0,[9061,5166,9843,3062,9017,2971,2472,1744],function(){return e(e.s=8487)}),_N_E=e.O()}]);