(()=>{var e={};e.id=424,e.ids=[424],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},877:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>r.a,__next_app__:()=>h,originalPathname:()=>g,pages:()=>d,routeModule:()=>m,tree:()=>c});var s=t(7096),n=t(6132),i=t(7284),r=t.n(i),l=t(2564),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(a,o);let c=["",{children:["chatagent",{children:["new",{children:["channels",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7127)),"D:\\111\\mybizai\\mybizai\\mybizai.app\\app\\chatagent\\new\\channels\\page.tsx"]}]},{}]},{}]},{loading:[()=>Promise.resolve().then(t.bind(t,9470)),"D:\\111\\mybizai\\mybizai\\mybizai.app\\app\\chatagent\\loading.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,6197)),"D:\\111\\mybizai\\mybizai\\mybizai.app\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],d=["D:\\111\\mybizai\\mybizai\\mybizai.app\\app\\chatagent\\new\\channels\\page.tsx"],g="/chatagent/new/channels/page",h={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/chatagent/new/channels/page",pathname:"/chatagent/new/channels",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7361:(e,a,t)=>{Promise.resolve().then(t.bind(t,3606))},3606:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>y});var s=t(3854),n=t(4218),i=t(1018),r=t(6104),l=t(1102),o=t(9425),c=t(2679),d=t(3718),g=t(8055),h=t(8861);let m=[{id:"whatsapp",name:"WhatsApp Business",icon:s.jsx(o.Z,{className:"w-5 h-5"}),description:"Connect your WhatsApp Business account",status:"available"},{id:"instagram",name:"Instagram Direct",icon:s.jsx(c.Z,{className:"w-5 h-5"}),description:"Connect your Instagram Business account",status:"available"},{id:"messenger",name:"Facebook Messenger",icon:s.jsx(d.Z,{className:"w-5 h-5"}),description:"Connect your Facebook Page",status:"available"},{id:"telegram",name:"Telegram Bot",icon:s.jsx(g.Z,{className:"w-5 h-5"}),description:"Connect your Telegram bot",status:"coming_soon"}];function p({channelsEnabled:e={},onChange:a}){return(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Channel Integration"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Connect your chat agent to messaging platforms"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Available Channels"}),s.jsx("div",{className:"space-y-3",children:m.map(a=>{let t=e[a.id]||!1;return(0,s.jsxs)("div",{className:`flex items-center justify-between p-4 border rounded-lg transition-all ${"coming_soon"===a.status?"opacity-60 bg-gray-50 dark:bg-gray-800/50":""}`,children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${"available"===a.status?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-400"}`,children:a.icon}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:a.name}),"coming_soon"===a.status&&s.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full",children:"Coming Soon"})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:a.description}),"available"===a.status&&s.jsx("div",{className:"flex items-center mt-2",children:s.jsx("span",{className:`text-xs ${t?"text-green-600 dark:text-green-400":"text-gray-500"}`,children:t?"● Active":"○ Inactive"})})]})]}),"available"===a.status&&s.jsx("div",{className:"flex items-center space-x-3",children:"whatsapp"===a.id||"instagram"===a.id||"messenger"===a.id?s.jsx(h.Z,{channel:a.id}):s.jsx(r.z,{size:"sm",disabled:!0,children:"Coming Soon"})})]},a.id)})})]})]})}var x=t(6361),u=t(8028);function y(){let e=(0,i.useRouter)(),a=(0,i.useSearchParams)(),{accessToken:t}=(0,x.tN)(),[o,c]=(0,n.useState)({}),[d,g]=(0,n.useState)(null),[h,m]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=a.get("agentId");e&&g(parseInt(e))},[a]);let y=async()=>{if(!d||!t){alert("Agent ID is missing. Please go back to the profile step.");return}try{m(!0),await u.TJ.updateChatAgent(d,{channels_enabled:o},t),e.push(`/chatagent/new/tools?agentId=${d}`)}catch(e){console.error("Failed to update agent channels:",e),alert("Failed to save channel configuration. Please try again.")}finally{m(!1)}};return d?s.jsx(l.Z,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Channel Integration"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Connect your chat agent to messaging platforms where customers can reach you"})]}),s.jsx(p,{channelsEnabled:o,onChange:c}),(0,s.jsxs)("div",{className:"flex justify-between",children:[s.jsx(r.z,{variant:"outline",onClick:()=>{if(!d){alert("Agent ID is missing. Please go back to the profile step.");return}e.push(`/chatagent/new/tools?agentId=${d}`)},disabled:h,children:"Skip for now"}),s.jsx(r.z,{onClick:y,disabled:h,isLoading:h,children:h?"Saving...":"Continue to Tools"})]})]})}):s.jsx(l.Z,{children:(0,s.jsxs)("div",{className:"text-center py-12",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"Agent not found"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Please go back to the profile step to create an agent first."}),s.jsx(r.z,{onClick:()=>e.push("/chatagent/new/profile"),children:"Back to Profile"})]})})}},8861:(e,a,t)=>{"use strict";t.d(a,{Z:()=>r});var s=t(3854),n=t(4218),i=t(6361);function r({channel:e}){let[a,t]=(0,n.useState)(!1),{accessToken:r}=(0,i.tN)(),l=()=>{switch(e){case"instagram":return"pages_show_list,pages_manage_metadata,instagram_basic,instagram_manage_messages,pages_messaging";case"messenger":return"pages_show_list,pages_manage_metadata,pages_messaging";default:return"whatsapp_business_management,whatsapp_business_messaging,business_management"}},o=()=>`http://localhost:8000/api/v1/auth/facebook/exchange?channel=${e}`;return s.jsx("button",{onClick:()=>{if(!window.FB){alert("Facebook SDK not loaded yet!");return}t(!0),window.FB.login(function(a){a.authResponse?(console.log(`FB login success for ${e}:`,a.authResponse),fetch(o(),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({accessToken:a.authResponse.accessToken,state:{channel:e}})}).then(e=>e.json()).then(a=>{console.log("Backend exchange result:",a),alert(`${e.charAt(0).toUpperCase()+e.slice(1)} connected successfully!`)}).catch(a=>{console.error(`Error connecting ${e}:`,a),alert(`Something went wrong while connecting ${e}.`)}).finally(()=>t(!1))):(alert("Login failed or cancelled"),t(!1))},{scope:l()})},disabled:a,className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:a?`Connecting ${e}...`:`Connect ${e.charAt(0).toUpperCase()+e.slice(1)}`})}},2679:(e,a,t)=>{"use strict";t.d(a,{Z:()=>n});var s=t(3708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]])},8055:(e,a,t)=>{"use strict";t.d(a,{Z:()=>n});var s=t(3708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},7127:(e,a,t)=>{"use strict";t.r(a),t.d(a,{$$typeof:()=>r,__esModule:()=>i,default:()=>o});var s=t(5153);let n=(0,s.createProxy)(String.raw`D:\111\mybizai\mybizai\mybizai.app\app\chatagent\new\channels\page.tsx`),{__esModule:i,$$typeof:r}=n,l=n.default,o=l}};var a=require("../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),s=a.X(0,[519,557,108,839,600],()=>t(877));module.exports=s})();